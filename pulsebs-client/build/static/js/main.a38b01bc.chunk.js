(this["webpackJsonppulsebs-client"]=this["webpackJsonppulsebs-client"]||[]).push([[0],{35:function(e,t,n){},47:function(e,t,n){},50:function(e,t,n){},59:function(e,t,n){"use strict";n.r(t);var r=n(1),s=n(0),a=n.n(s),c=n(36),i=n.n(c),o=(n(47),n(12)),u=n(15),l=n(20),h=n(17),d=n(16),j=n(30),b=n(24),p=n.n(b),f=n(13),m=n.n(f),O=n(21),x=n.n(O),g=n(14),v=n(41),k=n(38),y=n(11),S=n.n(y),w=n(18),C=function e(t,n,r,s,a,c,i,u,l){Object(o.a)(this,e),this.id=t,this.date=n,this.presence=r,this.bookable=s,this.active=a,this.courseDesc=c,this.teacherName=i,this.teacherSurname=u,this.CLdesc=l},N=function e(t,n,r){Object(o.a)(this,e),this.ref_student=t,this.ref_lecture=n,this.date=r};function F(){return(F=Object(w.a)(S.a.mark((function e(t,n){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:n})}).then((function(t){t.ok?t.json().then((function(t){e(t)})):t.json().then((function(e){r(e)})).catch((function(e){r({errors:[{param:"Application",msg:"Cannot parse server response"}]})}))})).catch((function(e){r({errors:[{param:"Server",msg:"Cannot communicate"}]})}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(){return(T=Object(w.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){fetch("/api/logout",{method:"POST"}).then((function(n){n.ok?e(null):n.json().then((function(e){t(e)})).catch((function(e){t({errors:[{param:"Application",msg:"Cannot parse server response"}]})}))}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(){return(L=Object(w.a)(S.a.mark((function e(){var t,n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/student/lectures",e.next=3,fetch("/api/student/lectures");case 3:return t=e.sent,e.next=6,t.json();case 6:if(n=e.sent,!t.ok){e.next=12;break}return console.log(n),e.abrupt("return",n.map((function(e){return new C(e.id,e.date,e.presence,e.bookable,e.active,e.desc,e.name,e.surname,e.desc)})));case 12:throw{status:t.status,errObj:n};case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(){return(E=Object(w.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("api:"+t),e.abrupt("return",new Promise((function(e,n){fetch("/api/student/booking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(t){t.ok?(console.log(t),e(t)):(console.log("errore msg"),t.json().then((function(e){n(e)})).catch((function(e){n({errors:[{param:"Application",msg:"Cannot parse server response"}]})})))})).catch((function(e){n({errors:[{param:"Server",msg:"Cannot communicate"}]})}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(){return(P=Object(w.a)(S.a.mark((function e(){var t,n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/student/bookings",e.next=3,fetch("/api/student/bookings");case 3:return t=e.sent,e.next=6,t.json();case 6:if(n=e.sent,!t.ok){e.next=11;break}return e.abrupt("return",n.map((function(e){return new N(e.ref_student,e.ref_lecture,e.date)})));case 11:throw{status:t.status,errObj:n};case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var D={login:function(e,t){return F.apply(this,arguments)},logout:function(){return T.apply(this,arguments)},getStudentLectures:function(){return L.apply(this,arguments)},bookSeat:function(e){return E.apply(this,arguments)},getStudentBookings:function(){return P.apply(this,arguments)}},I=(n(49),n(50),function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={email:"",password:"",redirect:!1,invalidCredentials:!1,userType:void 0},r}return Object(u.a)(n,[{key:"isEmailInvalid",value:function(e){return e.localeCompare("")?!e.includes("@"):void 0}},{key:"login",value:function(){var e=this;D.login(this.state.email,this.state.password).then((function(t){e.props.setFullName(t.name,t.surname,t.type),e.setState({redirect:!0,invalidCredentials:!1,userType:t.type})})).catch((function(t){console.log(t),e.setState({redirect:!1,invalidCredentials:!0})}))}},{key:"render",value:function(){var e=this;return Object(r.jsxs)(r.Fragment,{children:[this.state.redirect?Object(r.jsx)(x.a,{to:{pathname:0===this.state.userType?"/StudentHome":1===this.state.userType?"/TeacherHome":"/StaffHome"}}):void 0,Object(r.jsxs)(g.a,{id:"loginForm",children:[Object(r.jsx)("header",{children:Object(r.jsx)("h1",{children:"Login"})}),Object(r.jsxs)(g.a.Group,{controlId:"formEmail",children:[Object(r.jsx)(g.a.Label,{children:"Email address"}),Object(r.jsx)(g.a.Control,{type:"text",placeholder:"Enter email",isInvalid:this.isEmailInvalid(this.state.email),onChange:function(t){return e.setState({email:t.target.value})}}),Object(r.jsx)(g.a.Text,{className:"text-muted",children:"We'll never share your email with anyone else."})]}),Object(r.jsxs)(g.a.Group,{controlId:"formPassword",children:[Object(r.jsx)(g.a.Label,{children:"Password"}),Object(r.jsx)(g.a.Control,{type:"password",placeholder:"Password",onChange:function(t){return e.setState({password:t.target.value})}})]}),this.state.invalidCredentials?Object(r.jsx)(k.a,{className:"error",children:Object(r.jsx)("p",{children:"Invalid email or password."})}):void 0,Object(r.jsx)(v.a,{variant:"primary",disabled:!this.state.email.includes("@")||0===this.state.password.length,onClick:function(t){return e.login()},children:"Log in"})]})]})}}]),n}(a.a.Component)),Y=n(6),H=n(39),M=n(40),B=n(22),_=n.n(B),A=n(23),J=function(e){var t=e.lecture,n=e.bookSeat;return Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:t.id}),Object(r.jsx)("td",{children:_()(new Date(t.date)).format("YYYY-MM-DD")}),1===t.presence&&Object(r.jsx)("td",{children:"yes"}),0===t.presence&&Object(r.jsx)("td",{children:"no"}),Object(r.jsx)("td",{children:t.course}),Object(r.jsx)("td",{children:t.teacherName+" "+t.teacherSurname}),t.bookable&&Object(r.jsx)("td",{children:Object(r.jsx)(A.a,{width:"30",height:"30",className:"img-button",src:"svg/calendar.svg",alt:"Calendar",onClick:function(){return n(t)}})})]})},R=function(e){var t=e.lectures,n=e.bookSeat;return Object(r.jsx)(r.Fragment,{children:0!==t.length&&Object(r.jsxs)("table",{className:"table",id:"lectures-table",children:[Object(r.jsx)("thead",{children:Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{children:"Id"}),Object(r.jsx)("th",{children:"Date"}),Object(r.jsx)("th",{children:"Presence"}),Object(r.jsx)("th",{children:"Course"}),Object(r.jsx)("th",{children:"Teacher"}),Object(r.jsx)("th",{})]})}),Object(r.jsx)("tbody",{children:t.map((function(e){return Object(r.jsx)(J,{lecture:e,bookSeat:n},e.id)}))})]})})},G=function(e){var t=e.booking;return Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:_()(new Date(t.date)).format("YYYY-MM-DD")}),Object(r.jsx)("td",{children:t.ref_lecture}),Object(r.jsx)("td",{children:Object(r.jsx)(A.a,{width:"30",height:"30",className:"img-button",src:"svg/delete.svg",alt:""})})]})},W=function(e){var t=e.bookings;return Object(r.jsx)(r.Fragment,{children:0!==t.length&&Object(r.jsxs)("table",{className:"table",children:[Object(r.jsx)("thead",{children:Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{children:"Date"}),Object(r.jsx)("th",{children:"Course"}),Object(r.jsx)("th",{})]})}),Object(r.jsx)("tbody",{children:t.map((function(e){return Object(r.jsx)(G,{booking:e})}))})]})})},q=(n.p,n(35),function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).getStudentLectures=function(){D.getStudentLectures().then((function(e){return r.setState({lectures:e})})).catch((function(e){r.handleErrors(e)}))},r.getStudentReservations=function(){D.getStudentReservations().then((function(e){return r.setState({bookings:e})})).catch((function(e){r.handleErrors(e)}))},r.bookSeat=function(e){D.bookSeat(e).then((function(e){console.log(e),1===e?(r.setState({failed:0}),r.props.history.push("/bookings")):r.setState({failed:1})})).catch((function(e){r.handleErrors(e)}))},r.state={email:"",name:e.name,surname:e.surname,userType:"student",lectures:[],bookings:[],bookingFailed:""},r}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;D.getStudentLectures().then((function(t){D.getStudentBookings().then((function(n){e.setState((function(e,r){return{lectures:t,bookings:n}}))}))}))}},{key:"handleErrors",value:function(e){e&&e.status&&401===e.status&&(this.setState({authErr:e.errorObj}),this.props.history.push("/"))}},{key:"render",value:function(){return Object(r.jsx)(H.a,{fluid:!0,children:Object(r.jsxs)(p.a,{children:[Object(r.jsx)(m.a,{exact:!0,path:"/StudentHome",children:Object(r.jsx)(M.a,{className:"vheight-100",children:Object(r.jsxs)("div",{className:"list-group",children:[Object(r.jsx)("a",{className:"list-group-item list-group-item-action",role:"button","data-toggle":"collapse",href:"/lectures","aria-expanded":"false","aria-controls":"collapseExample",children:"Lectures"}),Object(r.jsx)("a",{className:"list-group-item list-group-item-action",role:"button","data-toggle":"collapse",href:"/bookings","aria-expanded":"false","aria-controls":"collapseExample",children:"Bookings"})]})})}),Object(r.jsx)(m.a,{exact:!0,path:"/lectures",children:Object(r.jsx)(R,{lectures:this.state.lectures,bookSeat:this.bookSeat})}),Object(r.jsx)(m.a,{exact:!0,path:"/bookings",children:Object(r.jsx)(W,{bookings:this.state.bookings})})]})})}}]),n}(a.a.Component)),z=Object(Y.withRouter)(q);var K=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={name:"",surname:"",type:void 0},r.setFullName=r.setFullName.bind(Object(l.a)(r)),r}return Object(u.a)(n,[{key:"setFullName",value:function(e,t,n){this.setState({name:e,surname:t,type:n})}},{key:"render",value:function(){return Object(r.jsx)(r.Fragment,{children:Object(r.jsxs)(p.a,{children:[Object(r.jsx)(m.a,{exact:!0,path:"/Login",children:Object(r.jsx)(I,{setFullName:this.setFullName})}),Object(r.jsx)(m.a,{exact:!0,path:"/StudentHome",children:Object(r.jsx)(z,{name:this.state.name,surname:this.state.surname})}),Object(r.jsx)(m.a,{exact:!0,path:"/TeacherHome"}),Object(r.jsx)(m.a,{exact:!0,path:"/",children:Object(r.jsx)(x.a,{to:"Login"})})]})})}}]),n}(a.a.Component),Q=function(){return Object(r.jsx)("div",{className:"App",children:Object(r.jsx)(j.a,{children:Object(r.jsx)(K,{})})})},U=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,60)).then((function(t){var n=t.getCLS,r=t.getFID,s=t.getFCP,a=t.getLCP,c=t.getTTFB;n(e),r(e),s(e),a(e),c(e)}))};i.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(Q,{})}),document.getElementById("root")),U()}},[[59,1,2]]]);
//# sourceMappingURL=main.a38b01bc.chunk.js.map